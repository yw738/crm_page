var ue=Object.defineProperty;var U=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var L=(s,o,n)=>o in s?ue(s,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[o]=n,C=(s,o)=>{for(var n in o||(o={}))se.call(o,n)&&L(s,n,o[n]);if(U)for(var n of U(o))re.call(o,n)&&L(s,n,o[n]);return s};import{_ as ie,d as V,q as J,ad as ce,r as m,L as P,X as pe,al as de,M as W,o as j,af as me,$ as w,am as H,E as z,a1 as M,a0 as R,a as v,b as f,f as E,x as i,h as u,e as q,F as he,g as be,c as O,y as Fe,U as ye}from"./index.6f18bade.js";import{M as fe}from"./Move2Sea.b332f790.js";import{F as ge}from"./FollowTask.e925c40f.js";import{A as _e}from"./add.3a7c70fe.js";import{C as De}from"./Convert2Customer.be7a69bd.js";import{U as ve}from"./index.d98f6ddf.js";import{D as Be}from"./DiversionClue.ad0d3159.js";import"./index.a2421c88.js";const Se=V({__name:"index",props:{activeName:{type:String}},emits:["openApp"],setup(s,{emit:o}){const n=s,{user:c}=J();ce("calsType","crm:clue:list");const h=m(null),b=m(null);let y=e=>{var l;(l=h==null?void 0:h.value)==null||l.init()};const t=P({msg:"\u53D1\u9001\u8BB0\u5F55\u53EA\u652F\u630120\u5929\u67E5\u8BE2\uFF0C\u5982\u9700\u66F4\u591A\u8BB0\u5F55\u8BF7\u8054\u7CFB\u5BA2\u670D",searchData:{keyWords:null,clientSource:null,clueState:null,belongUserId:null,followStartDate:null,followEndDate:null,isTopSort:!0},selectList:[],requestData:{companyId:c.userInfo.companyId},searchForm:[{type:"input",prop:"keyWords",width:"180px",placeholder:"\u641C\u7D22\u5173\u952E\u5B57",change:()=>{}},{type:"select",prop:"clientSource",placeholder:"\u7EBF\u7D22\u6765\u6E90",width:"180px",options:pe,change:()=>{}},{type:"select",prop:"followUpStatus",placeholder:"\u8DDF\u8FDB\u72B6\u6001",width:"180px",options:de,change:()=>{}},{type:"select",prop:"belongUserId",placeholder:"\u5F52\u5C5E\u4EBA\u5458",width:"180px",options:[],change:()=>{}},{type:"daterange",prop:"followStartDate",prop2:"followEndDate",placeholder:"\u6700\u540E\u8DDF\u8FDB",change:()=>{}}],searchHandle:[{label:"\u67E5\u8BE2",type:"primary",icon:"Search",handle:()=>Z()},{label:"\u91CD\u7F6E",handle:()=>Q()}],tableHandles:[],tableCols:[{label:"\u64CD\u4F5C",type:"Button",width:"340px",btnList:[{label:"\u8DDF\u8FDB",type:"primary",size:"small",icon:"Share",handle:(e,l)=>le(e)},{type:"primary",label:"\u7F16\u8F91",icon:"Edit",size:"small",handle:(e,l)=>ee(e)},{type:"primary",label:"\u7F6E\u9876",size:"small",icon:"SortUp",handle:(e,l)=>te(e)},{type:"danger",label:"\u5220\u9664",icon:"Delete",size:"small",handle:(e,l)=>ne(e)}]}],tableData:[],appTableData:[],pagination:{pageSize:10,pageIndex:1,total:0},treeData:[],allList:[]}),{msg:x,searchData:B,searchForm:p,searchHandle:S,tableHandles:$,tableCols:X,pagination:G,tableData:K}=W(t),Q=()=>{Object.assign(t.searchData,{keyWords:null,clientSource:null,clueState:null,belongUserId:null,followStartDate:null,followEndDate:null,followUpStatus:null,isTopSort:!0})};j(()=>{me("crm:clue:list").then(e=>{t.tableCols=[...e,...t.tableCols]}),n.activeName=="3"?t.tableHandles=[{label:"\u6DFB\u52A0",type:"primary",icon:"Plus",handle:()=>k()},{label:"\u5BFC\u5165",icon:"Upload",handle:e=>y()},{label:"\u5BFC\u51FA",icon:"Download",handle:()=>T()},{label:"\u8F6C\u79FB\u7EBF\u7D22",handle:()=>A()},{label:"\u79FB\u5165\u516C\u6D77",handle:()=>N()}]:(t.tableHandles=[{label:"\u6DFB\u52A0",type:"primary",icon:"Plus",handle:()=>k()},{label:"\u5BFC\u5165",icon:"Upload",handle:e=>y()},{label:"\u5BFC\u51FA",icon:"Download",handle:()=>T()},{label:"\u8F6C\u4E3A\u5BA2\u6237",handle:()=>ae()},{label:"\u8F6C\u79FB\u7EBF\u7D22",handle:()=>A()},{label:"\u79FB\u5165\u516C\u6D77",handle:()=>N()}],t.searchForm=t.searchForm.filter(e=>e.prop!=="belongUserId")),r(),w.queryEmployee().then(e=>{var l;t.searchForm[3].options=(l=e.data)==null?void 0:l.map(a=>({label:a.name,value:a.id}))})});let Y=e=>{t.selectList=e.selection},T=()=>{let e=JSON.parse(JSON.stringify(t.searchData)),{activeName:l}=n;e.queryType=H(n.activeName),l=="2"?fileDown("clue",e):l=="3"&&fileDown("underClue",e)},N=()=>{var l;let e=t.selectList.map(a=>a.clientId).join(",");(l=g==null?void 0:g.value)==null||l.init(e)},A=()=>{var l;let e=t.selectList.map(a=>a.clientId);(l=b==null?void 0:b.value)==null||l.init(e,"zhuanyi")};const Z=()=>{t.pagination.pageIndex=1,r()};m();const d=m(null),g=m(null),_=m(null),D=m(null);let k=()=>{var e;(e=d==null?void 0:d.value)==null||e.init("add",{clueType:0,customerType:3})},ee=(e,l)=>{var a;(a=d==null?void 0:d.value)==null||a.init("edit",C({clueType:0,customerType:3},e))},ae=()=>{var e;(e=D==null?void 0:D.value)==null||e.init(t.selectList)},le=(e,l)=>{var a;(a=_==null?void 0:_.value)==null||a.init("clue",e)},te=(e,l)=>{z.confirm("\u8BE5\u64CD\u4F5C\u5C06\u7F6E\u9876\u3002","\u786E\u5B9A\u7F6E\u9876\u5417\uFF1F").then(()=>{var a;(a=M)==null||a.top(e.clientId).then(F=>{R.success("\u7F6E\u9876\u6210\u529F"),I()})}).catch(()=>{})},ne=(e,l)=>{z.confirm("\u8BE5\u6570\u636E\u5C06\u6C38\u4E45\u88AB\u5220\u9664\uFF0C\u5E76\u4E14\u65E0\u6CD5\u6062\u590D\u3002\u786E\u5B9A\u5220\u9664\u5417\uFF1F","\u63D0\u793A").then(()=>{var a;(a=M)==null||a.del(e.clientId).then(F=>{R.success("\u5220\u9664\u6210\u529F"),I()})}).catch(()=>{})};const I=()=>{r()},r=async()=>{var l;let e=null;try{let a=JSON.parse(JSON.stringify(t.searchData));a.current=t.pagination.pageIndex,a.size=t.pagination.pageSize,a.queryType=H(n.activeName),a.queryType=="TRANSFERRED_CUSTOMER"?a.clientDistinguish=1:a.clientDistinguish=0;let{activeName:F}=n;F=="2"?e=await w.getClueList(a):F=="3"&&(e=await w.getClueUnderList(a)),t.tableData=((l=e==null?void 0:e.data.records)==null?void 0:l.map(oe=>C({},oe)))||[],t.pagination.total=(e==null?void 0:e.data.total)||0}catch{t.tableData=[]}};return(e,l)=>{const a=v("SearchForm"),F=v("TableTemp");return f(),E("div",null,[i(a,{id:"searchForm",searchData:u(B),searchForm:u(p),searchHandle:u(S)},null,8,["searchData","searchForm","searchHandle"]),i(F,{comheight:700,style:{width:"100%"},isBorder:!0,isSelection:!0,isIndex:!1,isPagination:!0,loading:!1,isHandle:!0,isShowPageBtn:!1,tableData:u(K),tableCols:u(X),tableHandles:u($),pagination:u(G),onRefresh:r,onSelectChage:u(Y)},null,8,["tableData","tableCols","tableHandles","pagination","onSelectChage"]),i(fe,{ref_key:"move2SeaRef",ref:g,onSuccess:r,type:"clue"},null,512),i(ge,{ref_key:"followTaskRef",ref:_,onSuccess:r},null,512),i(_e,{ref_key:"addRef",ref:d,onSuccess:r},null,512),i(ve,{ref_key:"uploadFileRef",ref:h,typeName:"clue",onSuccess:r},null,512),i(De,{ref_key:"convert2CustomerRef",ref:D,onSuccess:r},null,512),i(Be,{ref_key:"diversionClueRef",ref:b,onSuccess:r},null,512)])}}});var Ce=ie(Se,[["__scopeId","data-v-85231b3c"]]);const we={class:"main"},He=V({__name:"index",setup(s){const{user:o}=J(),n=P({activeName:"2",openId:null,openType:"",list:[{label:"\u6211\u7684\u7EBF\u7D22",value:"2"},{label:"\u4E0B\u5C5E\u7684\u7EBF\u7D22",value:"3"}]});j(()=>{o.userLevel==1&&(n.list=[{label:"\u6211\u7684\u7EBF\u7D22",value:"2"}]),n.activeName=n.list[0].value});const{activeName:c,list:h}=W(n),b=(y,t)=>{n.activeName=y.props.name};return(y,t)=>{const x=v("el-tab-pane"),B=v("el-tabs");return f(),E("div",we,[i(B,{modelValue:u(c),"onUpdate:modelValue":t[0]||(t[0]=p=>ye(c)?c.value=p:null),onTabClick:b,type:"border-card"},{default:q(()=>[(f(!0),E(he,null,be(u(h),(p,S)=>(f(),O(x,{label:p.label,key:S,name:p.value},{default:q(()=>[p.value==u(c)?(f(),O(Ce,{key:0,activeName:u(c)},null,8,["activeName"])):Fe("",!0)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])])}}});export{He as default};
