var oe=Object.defineProperty,se=Object.defineProperties;var ne=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var w=(c,i,p)=>i in c?oe(c,i,{enumerable:!0,configurable:!0,writable:!0,value:p}):c[i]=p,x=(c,i)=>{for(var p in i||(i={}))re.call(i,p)&&w(c,p,i[p]);if(P)for(var p of P(i))de.call(i,p)&&w(c,p,i[p]);return c},j=(c,i)=>se(c,ne(i));import{e as ie,t as pe,a as me,b as S}from"./AddTask.f5502617.js";import{_ as ce,d as fe,q as ge,r as R,V as L,L as _e,M as Fe,a as m,b as d,f as g,h as l,c as F,e as a,m as M,x as u,F as b,g as y,G as k,t as O,y as C,J as be,U as ye,$ as ke,a0 as Y}from"./index.6f18bade.js";const De=k("\u9009\u62E9"),Be=k(" \u7C73 "),ve=k(" \u8D85\u51FA\u6B64\u8303\u56F4\u7B7E\u5230\u5C06\u65E0\u6548 "),Ve={class:"dialog-footer",style:{"text-align":"center"}},Ie=k("\u4FDD\u5B58"),Ee=k("\u53D6\u6D88"),Ae=fe({__name:"AddTask2",emits:["success"],setup(c,{expose:i,emit:p}){const{user:T}=ge(),V=R(null),I=R(L),s=_e({title:"",visible:!1,formData:{taskId:"",clientId:"",startTime:"",emergencyLevel:"",taskDesciption:"",latitude:"",longitude:"",signSocpe:"",signAddressName:"",chargePersonId:"",joinPeopleIds:[],taskSign:"",taskUpReminder:"",followUpTypes:[]},rules:{startTime:[{required:!0,message:"\u8BF7\u9009\u62E9\u8DDF\u8FDB\u65F6\u95F4",trigger:"blur"}],clientId:[{required:!0,message:"\u8BF7\u9009\u62E9\u5BA2\u6237",trigger:"blur"}],taskDesciption:[{required:!0,message:"\u8BF7\u8F93\u5165\u8DDF\u8FDB\u5185\u5BB9",trigger:"blur"}],chargePersonId:[{required:!0,message:"\u8BF7\u9009\u62E9\u8DDF\u8FDB\u4EBA\u5458",trigger:"blur"}],signAddressName:[{required:!0,message:"\u8BF7\u9009\u62E9\u7B7E\u5230\u5730\u5740",trigger:"blur"}],signSocpe:[{required:!0,pattern:/^[0-9]*$/,message:"\u8BF7\u8F93\u5165\u6570\u5B57",trigger:"blur"}],joinPeopleIds:[{required:!0,message:"\u8BF7\u9009\u62E9\u6284\u9001\u4EBA\u5458",trigger:"blur"}]},options2:[],employeeList:[],employeeList2:[],props1:{checkStrictly:!0,value:"id",label:"name"},allList:[],openType:""}),{title:q,visible:B,formData:o,rules:J,options2:H,employeeList:z,employeeList2:$}=Fe(s);let G=async(r,t={})=>{ke.queryEmployee().then(D=>{var _;let n=(_=D.data)==null?void 0:_.map(f=>({label:f.name,value:f.id}));s.employeeList=n,s.employeeList2=n.filter(f=>f.value!=T.userInfo.id)}),r=="edit"?(s.title="\u7F16\u8F91\u4EFB\u52A1",await S.getDetail(t.taskId).then(D=>{let{taskDetailsVO:n}=D.data;Object.assign(s.formData,j(x({},n),{joinPeopleIds:n.joinPeopleIds?n.joinPeopleIds.split(","):[],taskUpType:n.taskUpType?n.taskUpType.split(","):[]}))})):(s.title="\u65B0\u5EFA\u4EFB\u52A1",s.formData.chargePersonId=T.userInfo.id),s.openType=r,s.visible=!0};function K(){V.value.init("add",{})}function Q(){V.value.init("disable",{local:"",address:"",lng:s.formData.longitude,lat:s.formData.latitude})}function W(r={}){s.formData.latitude=r.lat,s.formData.longitude=r.lng,s.formData.signAddressName=r.address}function X(){let r=JSON.parse(JSON.stringify(s.formData));r.joinPeopleIds=r.joinPeopleIds.join(","),r.followUpTypes=["SYSTEM_INFORMATION"],S.addFollow(r).then(()=>{Y.success("\u65B0\u589E\u6210\u529F\uFF01"),v(),p("success")})}function Z(){let r=JSON.parse(JSON.stringify(s.formData));r.joinPeopleIds=r.joinPeopleIds.join(","),r.followUpTypes=["SYSTEM_INFORMATION"],S.updateFollow(r).then(()=>{Y.success("\u7F16\u8F91\u6210\u529F\uFF01"),v(),p("success")})}function ee(){s.formData,I.value.validate(r=>{r&&(s.openType=="edit"?Z():X())})}function v(){I.value.resetFields(),s.visible=!1,s.title="",Object.assign(s.formData,{taskId:"",clientId:"",startTime:"",emergencyLevel:"",taskDesciption:"",latitude:"",longitude:"",signSocpe:"",signAddressName:"",chargePersonId:"",joinPeopleIds:[],taskSign:"",taskUpReminder:"",followUpTypes:[]})}return i({init:G}),(r,t)=>{const D=m("el-date-picker"),n=m("el-form-item"),_=m("el-option"),f=m("el-select"),U=m("el-input"),h=m("el-radio"),N=m("el-radio-group"),E=m("el-button"),le=m("el-checkbox"),ue=m("el-checkbox-group"),ae=m("el-dialog"),te=m("Map");return d(),g(b,null,[l(B)?(d(),F(ae,{key:0,title:l(q),modelValue:l(B),"onUpdate:modelValue":t[10]||(t[10]=e=>ye(B)?B.value=e:null),width:"700px",onClose:v,"close-on-click-modal":!1,"append-to-body":""},{footer:a(()=>[M("div",Ve,[u(E,{type:"primary",onClick:ee},{default:a(()=>[Ie]),_:1}),u(E,{onClick:v},{default:a(()=>[Ee]),_:1})])]),default:a(()=>[u(l(L),{ref_key:"dataFormRef",ref:I,model:l(o),rules:l(J),"label-width":"130px"},{default:a(()=>[u(n,{label:"\u8DDF\u8FDB\u65F6\u95F4:",prop:"startTime"},{default:a(()=>[u(D,{modelValue:l(o).startTime,"onUpdate:modelValue":t[0]||(t[0]=e=>l(o).startTime=e),style:{width:"100%"},type:"datetime",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"\u8BF7\u9009\u62E9"},null,8,["modelValue"])]),_:1}),u(n,{label:"\u5173\u8054\u5BA2\u6237:",prop:"clientId"},{default:a(()=>[u(f,{modelValue:l(o).clientId,"onUpdate:modelValue":t[1]||(t[1]=e=>l(o).clientId=e),style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9"},{default:a(()=>[(d(!0),g(b,null,y(l(H),e=>(d(),F(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(n,{label:"\u8DDF\u8FDB\u5185\u5BB9:",prop:"taskDesciption"},{default:a(()=>[u(U,{modelValue:l(o).taskDesciption,"onUpdate:modelValue":t[2]||(t[2]=e=>l(o).taskDesciption=e),placeholder:"\u8BF7\u8F93\u5165"},null,8,["modelValue"])]),_:1}),u(n,{label:"\u7D27\u8981\u7A0B\u5EA6:"},{default:a(()=>[u(N,{modelValue:l(o).emergencyLevel,"onUpdate:modelValue":t[3]||(t[3]=e=>l(o).emergencyLevel=e),class:"ml-4"},{default:a(()=>[(d(!0),g(b,null,y(l(ie),(e,A)=>(d(),F(h,{label:e.value,size:"large",key:A},{default:a(()=>[k(O(e.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(n,{label:"\u8DDF\u8FDB\u4EBA\u5458:",prop:"chargePersonId"},{default:a(()=>[u(f,{modelValue:l(o).chargePersonId,"onUpdate:modelValue":t[4]||(t[4]=e=>l(o).chargePersonId=e),style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9"},{default:a(()=>[(d(!0),g(b,null,y(l(z),e=>(d(),F(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(n,{label:"\u7B7E\u5230\u5730\u5740:",prop:"signAddressName"},{default:a(()=>[l(o).signAddressName?(d(),g("span",{key:0,class:"marginR30 clickBtn",onClick:Q},O(l(o).signAddressName),1)):C("",!0),u(E,{type:"primary",onClick:K},{default:a(()=>[De]),_:1})]),_:1}),u(n,{label:"\u7B7E\u5230\u8303\u56F4:",prop:"signSocpe"},{default:a(()=>[u(U,{modelValue:l(o).signSocpe,"onUpdate:modelValue":t[5]||(t[5]=e=>l(o).signSocpe=e),placeholder:"\u8BF7\u8F93\u5165"},{suffix:a(()=>[Be]),_:1},8,["modelValue"]),ve]),_:1}),u(n,{label:"\u6284\u9001\u4EBA\u5458:",prop:"joinPeopleIds"},{default:a(()=>[u(f,{modelValue:l(o).joinPeopleIds,"onUpdate:modelValue":t[6]||(t[6]=e=>l(o).joinPeopleIds=e),style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9",multiple:""},{default:a(()=>[(d(!0),g(b,null,y(l($),e=>(d(),F(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(n,{label:"\u4EFB\u52A1\u6807\u8BB0:"},{default:a(()=>[u(N,{modelValue:l(o).taskSign,"onUpdate:modelValue":t[7]||(t[7]=e=>l(o).taskSign=e),class:"ml-4"},{default:a(()=>[(d(!0),g(b,null,y(l(pe),(e,A)=>(d(),F(h,{label:e.value,size:"large",key:A},{default:a(()=>[M("span",{class:"round2",style:be({background:e.color})},null,4)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(n,{label:"\u4EFB\u52A1\u63D0\u9192:"},{default:a(()=>[u(f,{modelValue:l(o).taskUpReminder,"onUpdate:modelValue":t[8]||(t[8]=e=>l(o).taskUpReminder=e),style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9"},{default:a(()=>[(d(!0),g(b,null,y(l(me),e=>(d(),F(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(n,{label:"\u63D0\u9192\u65B9\u5F0F:"},{default:a(()=>[u(le,{label:"\u7CFB\u7EDF\u6D88\u606F",key:"SYSTEM_INFORMATION",checked:!0,disabled:!0,style:{"margin-right":"20px"}}),u(ue,{modelValue:l(o).followUpTypes,"onUpdate:modelValue":t[9]||(t[9]=e=>l(o).followUpTypes=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])):C("",!0),u(te,{ref_key:"mapRef",ref:V,onSuccess:W},null,512)],64)}}});var he=ce(Ae,[["__scopeId","data-v-19204884"]]);export{he as A};
