var Ee=Object.defineProperty,Te=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var fe=Object.getOwnPropertySymbols;var $e=Object.prototype.hasOwnProperty,Ne=Object.prototype.propertyIsEnumerable;var be=(b,v,w)=>v in b?Ee(b,v,{enumerable:!0,configurable:!0,writable:!0,value:w}):b[v]=w,U=(b,v)=>{for(var w in v||(v={}))$e.call(v,w)&&be(b,w,v[w]);if(fe)for(var w of fe(v))Ne.call(v,w)&&be(b,w,v[w]);return b},J=(b,v)=>Te(b,Ie(v));import{d as Q,an as ye,q,s as ae,u as le,L as H,w as Pe,A as X,W as Ve,ah as Re,Y as Le,X as Oe,aG as Ue,ar as De,a3 as ze,M as K,aH as xe,a as x,b as f,f as V,x as a,e as p,F as ee,g as ne,c as O,G as I,t as N,h as e,m as l,aA as te,au as je,_ as de,r as z,V as ge,y as L,U as ce,p as ve,l as Fe,E as pe,a0 as Y,a5 as he,K as we,o as Je,ad as We,n as oe,J as Me,a4 as ie}from"./index.6f18bade.js";import{f as Ce,F as Qe}from"./FollowTask.e925c40f.js";import{A as qe}from"./add.85cd694e.js";import{A as He}from"./add.4d672949.js";import{C as Ke}from"./Convert2Customer.be7a69bd.js";import{A as Xe}from"./add.3a7c70fe.js";import{g as Ge,A as Ye}from"./AddTask.f5502617.js";import{A as Ze}from"./AddTask2.d19b3af9.js";import{A as et}from"./AddCooperation.9a64fde0.js";import{O as tt}from"./add.cb8cec8f.js";import{F as me}from"./index.5a1c8eed.js";import{_ as at}from"./contacts.221eefff.js";import{_ as lt}from"./index.5f93f5a1.js";import{p as re}from"./product.3072bf93.js";import"./dict.c33b8edc.js";import"./index.0bd58103.js";const ot=[{label:"\u5546\u673A\u6807\u9898",value:"businessTitle"},{label:"\u5173\u8054\u5BA2\u6237",value:"clientName",type:1},{label:"\u9884\u8BA1\u9500\u552E\u91D1\u989D",value:"salesAmount"},{label:"\u9884\u8BA1\u7B7E\u5355\u65E5\u671F",value:"dateSign"},{label:"\u5546\u673A\u6765\u6E90",value:"businessSource"},{label:"\u5F52\u5C5E\u4EBA\u5458",value:"belongUserName"},{label:"\u5907\u6CE8\u4FE1\u606F",value:"businessRemark"}],nt=[{label:"\u7CFB\u7EDF\u7F16\u53F7",value:"clientId"},{label:"\u534F\u4F5C\u4EBA\u5458",value:"cooperationUserName"},{label:"\u521B\u5EFA\u4EBA\u5458",value:"creatorName"},{label:"\u524D\u5F52\u5C5E\u4EBA",value:"oldUserName"},{label:"\u521B\u5EFA\u65F6\u95F4",value:"createTime"},{label:"\u66F4\u65B0\u65F6\u95F4",value:"updateTime"},{label:"\u6700\u540E\u8DDF\u8FDB",value:"followTime"},{label:"\u672A\u8DDF\u8FDB\u5929\u6570",value:"followTime"}];const st={key:0},ut={key:1},it={class:"flexBetween"},rt=l("div",null,null,-1),dt={key:3},ct=Q({__name:"index",props:{row:{type:Object,default:{}}},emits:["success"],setup(b,{expose:v,emit:w}){const d=b,s=ye("openLink");q(),ae();const u=le(),n=H({formData:{},formData2:{a:"xxx"},checked1:!1,tableData:[],pagination:{pageSize:10,pageIndex:1,total:0}});Pe(d.row,m=>{c()}),X(()=>{c(),P()});let c=async()=>{let m=d.row;n.formData=J(U({},m),{clientType:findLabel(Ve,m.clientType),clientState:findLabel(Re,m.clientState),clientIndustry:findLabel(Le,m.clientIndustry),clientSource:findLabel(Oe,m.clientSource),clueRole:findLabel(Ue,m.clueRole),salesStage:findLabel(De,m.salesStage),businessSource:findLabel(ze,m.businessSource),salesAmount:"\xA5 "+m.salesAmount})};const{formData:S,formData2:R,checked1:A,tableData:D,pagination:_}=K(n),g=()=>{s(n.formData)},P=async()=>{var C;let m=null;try{let k=u.query.businessId,F={followInfoType:"BUSINESS",detailsId:k,current:n.pagination.pageIndex,size:n.pagination.pageSize};m=await Ce.getList(F);let B=((C=m.data.records)==null?void 0:C.map(h=>{var r;return J(U({},h),{followType:findLabel(xe,h.followType),hollow:!1,followInfoType:F.followInfoType,time:(r=h.createTime)==null?void 0:r.split(" ")[0]})}))||[];n.tableData=B}catch{n.tableData=[]}};return v({init:c}),(m,C)=>{const k=x("el-link"),F=x("el-descriptions-item"),B=x("el-descriptions"),h=x("el-col"),r=x("el-row");return f(),V("div",null,[a(r,{gutter:20},{default:p(()=>[a(h,{span:12},{default:p(()=>[a(B,{title:"\u57FA\u672C\u4FE1\u606F",class:"marginB20",column:2,border:""},{default:p(()=>[(f(!0),V(ee,null,ne(e(ot),(o,E)=>(f(),O(F,{"label-align":"right",align:"left",label:o.label,key:E,"label-class-name":"my-label2","class-name":"my-content"},{default:p(()=>[o.type==1?(f(),V("span",st,[a(k,{onClick:C[0]||(C[0]=T=>g()),underline:!1,type:"primary"},{default:p(()=>[I(N(e(S)[o.value]||"-"),1)]),_:2},1024)])):o.type==2?(f(),V("span",ut,[l("div",it,[l("div",null,N(e(S)[o.value]||"-"),1),rt])])):(f(),V("span",dt,N(e(S)[o.value]||"-"),1))]),_:2},1032,["label"]))),128))]),_:1}),a(B,{title:"\u7CFB\u7EDF\u4FE1\u606F",class:"marginB20",column:2,border:""},{default:p(()=>[(f(!0),V(ee,null,ne(e(nt),(o,E)=>(f(),O(F,{"label-align":"right",align:"left",label:o.label,key:E,"label-class-name":"my-label2","class-name":"my-content"},{default:p(()=>[l("span",null,N(e(S)[o.value]||"-"),1)]),_:2},1032,["label"]))),128))]),_:1})]),_:1}),a(h,{span:12},{default:p(()=>[a(me,{style:{height:"730px"},title:"\u8DDF\u8FDB\u8BB0\u5F55",tableData:e(D),pagination:e(_),"is-show-pagination":!1},null,8,["tableData","pagination"])]),_:1})]),_:1})])}}});const pt=Q({__name:"index",props:{row:{type:Object,default:{}}},emits:["success"],setup(b,{expose:v,emit:w}){const d=b;q();const s=H({searchData:{a:"xxx"},checked1:!1,tableData:[],pagination:{pageSize:10,pageIndex:1,total:0}});K(s);let u=async(n={})=>{};return X(()=>{u()}),v({init:u}),(n,c)=>(f(),V("div",null,[a(at,{row:d.row},null,8,["row"])]))}});const mt={class:"flexStart"},_t=Q({__name:"index",emits:["success"],setup(b,{expose:v,emit:w}){ae();const d=le();q();const s=H({searchData:{startDate:"",endDate:"",keyWords:""},checked1:!1,tableData:[],clientId:"",pagination:{pageSize:10,pageIndex:1,total:0}}),{searchData:u,checked1:n,tableData:c,pagination:S}=K(s);let R=async(D={})=>{};X(()=>{A(),s.clientId=d.query.clientId});const A=async()=>{var _;let D=null;try{let g=JSON.parse(JSON.stringify(s.searchData));g.current=s.pagination.pageIndex,g.size=s.pagination.pageSize,D=await Ce.getList(g),g.detailsId=s.clientId,g.followInfoType="BUSINESS";let P=((_=D.data.records)==null?void 0:_.map(C=>{var k;return J(U({},C),{followType:xe.filter(F=>F.value==C.followType)[0].label,hollow:!1,followInfoType:g.followInfoType,time:(k=C.createTime)==null?void 0:k.split(" ")[0]})}))||[],m=[...new Set(P.map(C=>C.time))];s.tableData=P,s.pagination.total=D.data.total||0}catch{s.tableData=[]}};return v({init:R}),(D,_)=>{const g=x("DateRangeCom"),P=x("el-input");return f(),V("div",null,[a(me,{style:{height:"730px"},title:"\u8DDF\u8FDB\u8BB0\u5F55",tableData:e(c),pagination:e(S),fileDownType:"sendDetail",searchData:e(u)},{default:p(()=>[l("div",mt,[a(g,{starTime:e(u).start,"onUpdate:starTime":_[0]||(_[0]=m=>e(u).start=m),endTime:e(u).end,"onUpdate:endTime":_[1]||(_[1]=m=>e(u).end=m),width:"220px",style:{"margin-right":"10px"}},null,8,["starTime","endTime"]),a(P,{style:{"margin-right":"10px",width:"200px"},modelValue:e(u).description,"onUpdate:modelValue":_[2]||(_[2]=m=>e(u).description=m),placeholder:"\u8BF7\u8DDF\u8FDB,\u591A\u7B7E\u5355"},null,8,["modelValue"])])]),_:1},8,["tableData","pagination","searchData"])])}}});const ft=Q({__name:"index",emits:["success"],setup(b,{expose:v,emit:w}){q();const d=H({});K(d);let s=async(u={})=>{};return X(()=>{s()}),v({init:s}),(u,n)=>(f(),V("div",null,[a(lt)]))}});const bt=l("div",{class:"flexBetween",style:{"margin-bottom":"20px"}},[l("div",null,"\u8BA2\u5355\u8BB0\u5F55")],-1),gt=Q({__name:"index",props:{row:{type:Object,default:{}}},emits:["success"],setup(b,{emit:v}){const w=b,d=ae();le(),q();const s=H({searchData:{},checked1:!1,tableCols:[{label:"\u8BA2\u5355\u6807\u9898",prop:"orderTitile",itemClass:()=>"openClass",handle:D=>R(D)},{label:"\u8BA2\u5355\u603B\u91D1\u989D",prop:"orderTotalMoney"},{label:"\u5F00\u59CB\u65E5\u671F",prop:"startTime"},{label:"\u7ED3\u675F\u65E5\u671F",prop:"endTime"},{label:"\u8BA2\u5355\u72B6\u6001",prop:"orderState"},{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"},{label:"\u5907\u6CE8",prop:"remarks"}],tableData:[],pagination:{pageSize:10,pageIndex:1,total:0}}),{searchData:u,checked1:n,tableData:c,tableCols:S}=K(s);let R=D=>{d.push({path:"/detailManage/order",query:{orderId:D.orderId}})};X(()=>{A()});const A=async()=>{var _;let D=null;try{let g=JSON.parse(JSON.stringify(s.searchData));g.current=s.pagination.pageIndex,g.size=s.pagination.pageSize,D=await te.associatedOrder(w.row.businessId),s.tableData=((_=D.data)==null?void 0:_.map(P=>J(U({},P),{orderState:findLabel(je,P.orderState)})))||[]}catch{s.tableData=[]}};return(D,_)=>{const g=x("TableTemp");return f(),V("div",null,[bt,a(g,{comheight:360,isBorder:!0,isSelection:!1,isIndex:!1,isPagination:!1,loading:!1,isHandle:!0,tableData:e(c),tableCols:e(S),onRefresh:A,headerStyle:{background:"rgb(245 245 245)",color:"#666666",fontSize:"14px",fontWeight:700,height:"49px"}},null,8,["tableData","tableCols","headerStyle"])])}}});const _e=b=>(ve("data-v-3663f821"),b=b(),Fe(),b),ht=I("\u5220\u9664"),yt={class:"flexBetween marginT20"},Dt={class:"flexStart bottom_box"},xt={class:"marginR10"},vt=_e(()=>l("span",null,"\u4EA7\u54C1\u62A5\u4EF7\u8BB0\u5F55\uFF1A",-1)),Ft={style:{color:"red"}},wt=I(" \u6761 "),Ct={class:"marginR10"},At=_e(()=>l("span",null,"\u4EA7\u54C1\u603B\u6570\u91CF\uFF1A",-1)),St={style:{color:"red"}},kt=I(" \u4E2A "),Bt={class:"marginR10"},Et=_e(()=>l("span",null,"\u4EA7\u54C1\u603B\u91D1\u989D\uFF1A",-1)),Tt={style:{color:"red"}},It=I(" \u5143 "),$t={class:"dialog-footer",style:{"text-align":"center","margin-top":"30px"}},Nt=I("\u8FD4\u56DE"),Pt=I("\u63D0\u4EA4\u62A5\u4EF7"),Vt=Q({__name:"ConfirmQuotation",props:{row:{type:Object,default:{}}},emits:["success","back"],setup(b,{expose:v,emit:w}){const d=b;q();const s=z(ge),u=H({title:"",visible:!1,formData:{productId:"",salePrice:"",saleNumber:"",discount:0,totalPrice:0,gift:"",remark:""},treeData:[],rightTree:[],checkedKeys:[],selectList:[],pagination:{pageSize:10,pageIndex:1,total:0},tableData:[],openType:"",infoData:{productAllNum:0,productAllmoney:0,allDiscount:0,allTotalPrice:0}}),{tableData:n,visible:c,formData:S,pagination:R,infoData:A}=K(u);let D=async(h,r=[])=>{u.visible=!0,u.tableData=r.map(o=>J(U({},o),{salePrice:o.salePrice||0,saleNumber:o.saleNumber||0,discount:o.discount||0,totalPrice:o.totalPrice||0,gift:o.gift||"",remark:o.remark||""})),u.openType=h,g()},_=h=>{u.selectList=h.selection};X(()=>{C()});let g=()=>{let h=JSON.parse(JSON.stringify(u.tableData)),r={productAllNum:0,productAllmoney:0,allDiscount:0,allTotalPrice:0};h.forEach(o=>{r.productAllNum=+r.productAllNum+ +o.saleNumber;let E=+o.standardPrice*+o.saleNumber;r.productAllmoney=+r.productAllmoney+E,r.allDiscount=+r.allDiscount+ +o.discount,r.allTotalPrice=+r.allTotalPrice+ +o.totalPrice}),u.infoData=J(U({},r),{allDiscount:Number(r.allDiscount/h.length*100)/100})},P=h=>{let r=(100-+h.discount)/100;h.totalPrice=h.salePrice*h.saleNumber*r;let o=JSON.parse(JSON.stringify(u.tableData));u.tableData=o,g()},m=(h,r)=>{pe.confirm("\u662F\u5426\u786E\u5B9A\u5220\u9664\u7528\u6237?","\u64CD\u4F5C\u786E\u8BA4").then(()=>{let o=JSON.parse(JSON.stringify(u.tableData));o.splice(r,1),u.tableData=o}).catch(()=>{})},C=()=>{};function k(){w("back"),B()}async function F(){let h=u.tableData.map(o=>o.businessProductId)||[],r=u.tableData.map(o=>({productId:o.productId,salePrice:o.salePrice,saleNumber:o.saleNumber,discount:o.discount,totalPrice:o.totalPrice,gift:o.gift,remark:o.remark}));u.openType=="add"?(await te.addBusProduct({businessId:d.row.businessId,businessProductDTOS:r}).catch(()=>{}),Y.success("\u65B0\u5EFA\u6210\u529F")):(await te.updateBusProduct({businessId:d.row.businessId,businessProductIds:h,businessProductDTOS:r}).catch(()=>{}),Y.success("\u7F16\u8F91\u6210\u529F")),w("success",r),B()}function B(){u.visible=!1,u.tableData=[]}return v({init:D}),(h,r)=>{const o=x("el-table-column"),E=x("el-input-number"),T=x("el-input"),$=x("el-button"),W=x("el-table");x("el-pagination");const M=x("el-form-item"),G=x("el-dialog");return e(c)?(f(),O(G,{key:0,title:"\u786E\u8BA4\u62A5\u4EF7",modelValue:e(c),"onUpdate:modelValue":r[4]||(r[4]=t=>ce(c)?c.value=t:null),width:"1400px",onClose:B,"close-on-click-modal":!1,"append-to-body":""},{default:p(()=>[l("div",null,[a(W,{ref:"multipleTableRef",border:!0,data:e(n),height:"500px",onSelectionChange:e(_)},{default:p(()=>[a(o,{label:"\u4EA7\u54C1\u540D\u79F0",property:"productName"}),a(o,{label:"\u4EA7\u54C1\u7F16\u53F7",property:"productNumber"}),a(o,{label:"\u6807\u51C6\u5355\u4EF7",property:"standardPrice"}),a(o,{label:"\u9500\u552E\u5355\u4EF7(\u5143)"},{default:p(t=>[a(E,{modelValue:t.row.salePrice,"onUpdate:modelValue":i=>t.row.salePrice=i,min:0,step:.01,max:99999999999999,style:{width:"100%","text-align":"left"},controls:!1,onBlur:i=>e(P)(t.row)},null,8,["modelValue","onUpdate:modelValue","step","onBlur"])]),_:1}),a(o,{label:"\u6570\u91CF"},{default:p(t=>[a(E,{modelValue:t.row.saleNumber,"onUpdate:modelValue":i=>t.row.saleNumber=i,min:0,max:99999999999999,style:{width:"100%","text-align":"left"},controls:!1,onBlur:i=>e(P)(t.row)},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),_:1}),a(o,{label:"\u6298\u6263\u7387(%)"},{default:p(t=>[a(E,{modelValue:t.row.discount,"onUpdate:modelValue":i=>t.row.discount=i,min:0,max:100,style:{width:"100%","text-align":"left"},controls:!1,onBlur:i=>e(P)(t.row)},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),_:1}),a(o,{label:"\u603B\u4EF7(\u5143)"},{default:p(t=>[a(E,{modelValue:t.row.totalPrice,"onUpdate:modelValue":i=>t.row.totalPrice=i,disabled:!0,min:0,max:99999999999999,style:{width:"100%","text-align":"left"},controls:!1},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(o,{property:"productSpecification",label:"\u4EA7\u54C1\u89C4\u683C"}),a(o,{label:"\u793C\u54C1",width:"180px"},{default:p(t=>[a(T,{style:{width:"150px"},modelValue:t.row.gift,"onUpdate:modelValue":i=>t.row.gift=i},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(o,{label:"\u5907\u6CE8",width:"180px"},{default:p(t=>[a(T,{style:{width:"150px"},modelValue:t.row.remark,"onUpdate:modelValue":i=>t.row.remark=i},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(o,{label:"\u64CD\u4F5C",width:"100px"},{default:p(t=>[t.$index!=0?(f(),O($,{key:0,type:"danger",size:"small",plain:!0,icon:"Delete",onClick:i=>e(m)(t.row,t.$index)},{default:p(()=>[ht]),_:2},1032,["onClick"])):L("",!0)]),_:1})]),_:1},8,["data","onSelectionChange"]),L("",!0)]),l("div",yt,[l("div",Dt,[l("div",xt,[vt,l("span",Ft,N(e(n).length),1),wt]),l("div",Ct,[At,l("span",St,N(e(A).productAllNum),1),kt]),l("div",Bt,[Et,l("span",Tt,N(e(A).productAllmoney),1),It])]),l("div",null,[a(e(ge),{ref_key:"dataFormRef",ref:s,inline:!0,model:e(S),"label-width":"120px"},{default:p(()=>[a(M,{label:"\u6574\u5355\u6298\u6263\u7387(%):",style:{"margin-bottom":"0"}},{default:p(()=>[a(T,{style:{width:"180px"},disabled:!0,modelValue:e(A).allDiscount,"onUpdate:modelValue":r[0]||(r[0]=t=>e(A).allDiscount=t)},null,8,["modelValue"])]),_:1}),a(M,{label:"\u62A5\u4EF7\u603B\u91D1\u989D(\u5143):",style:{"margin-bottom":"0"}},{default:p(()=>[a(T,{style:{width:"180px"},disabled:!0,modelValue:e(A).allTotalPrice,"onUpdate:modelValue":r[1]||(r[1]=t=>e(A).allTotalPrice=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),l("div",$t,[a($,{type:"primary",onClick:r[2]||(r[2]=t=>k())},{default:p(()=>[Nt]),_:1}),a($,{type:"primary",onClick:r[3]||(r[3]=t=>F())},{default:p(()=>[Pt]),_:1})])]),_:1},8,["modelValue"])):L("",!0)}}});var Ae=de(Vt,[["__scopeId","data-v-3663f821"]]);const Rt={class:"flexStart permissionBox"},Lt={class:"left",style:{width:"200px"}},Ot={class:"right"},Ut={class:"flexBetween marginB20 marginT20"},zt=I("\u5DF2\u9009\u62E9 "),jt={style:{color:"#0079fe"}},Jt=I(" \u4E2A\u4EA7\u54C1"),Wt={class:"dialog-footer",style:{"text-align":"center","margin-top":"30px"}},Mt=I("\u786E\u8BA4\u62A5\u4EF7"),Qt=Q({__name:"SeleProduct",props:{row:{type:Object,default:{}}},emits:["success"],setup(b,{expose:v,emit:w}){const d=b;q();const s={children:"childProductClassifyList",label:"classifyName"},u=z(null),n=z(null),c=H({title:"",visible:!1,formData:{productClassifyId:"",keyWords:""},treeData:[],rightTree:[],leftTree:[],checkedKeys:[],selectList:[],pagination:{pageSize:10,pageIndex:1,total:0},tableCols:[{label:"\u4EA7\u54C1\u540D\u79F0",prop:"productName"},{label:"\u4EA7\u54C1\u7F16\u53F7",prop:"productNumber"},{label:"\u6807\u51C6\u5355\u4EF7",prop:"standardPrice"},{label:"\u4EA7\u54C1\u89C4\u683C",prop:"productSpecification"},{label:"\u5907\u6CE8\u4FE1\u606F",prop:"remark"}],tableData:[],checkedArr:[]}),{tableData:S,tableCols:R,visible:A,formData:D,pagination:_,leftTree:g,rightTree:P,checkedKeys:m}=K(c);let C=async(T=[])=>{c.visible=!0,c.checkedArr=(T==null?void 0:T.map($=>J(U({},$),{id:$.productId})))||[],he.getType().then($=>{c.leftTree=$.data,c.formData.productClassifyId=$.data[0].productClassifyId,h()})},k=T=>{c.selectList=T.selection};X(()=>{});let F=T=>{w("success",T),E()},B=T=>{},h=()=>{let T=JSON.parse(JSON.stringify(c.formData));he.getList(T).then($=>{var M,G;let W=((M=c.checkedArr)==null?void 0:M.map(t=>t.id))||[];c.tableData=((G=$.data.records)==null?void 0:G.map(t=>{if(W!=null&&W.includes(t.productId)){let i=c.checkedArr.find(j=>j.id==t.productId)||{};return J(U(U({id:t.productId},t),i),{productSpecification:findLabel(re,t.productSpecification)})}else return J(U({id:t.productId},t),{productSpecification:findLabel(re,t.productSpecification)})}))||[],we(()=>{n==null||n.value.allChecked(c.checkedArr)}),c.pagination.total=$.data.total||0})};function r(T,$,W){c.formData.productClassifyId=T.productClassifyId,h()}function o(){if(!c.selectList.length){Y.error("\u8BF7\u9009\u62E9\u4EA7\u54C1!");return}let T=JSON.parse(JSON.stringify(c.selectList));u.value.init("add",T)}function E(){c.visible=!1,c.tableData=[],c.leftTree=[],c.selectList=[]}return v({init:C}),(T,$)=>{const W=x("el-tree"),M=x("el-divider"),G=x("el-input"),t=x("TableTemp"),i=x("el-button"),j=x("el-dialog");return f(),V(ee,null,[e(A)?(f(),O(j,{key:0,title:"\u9009\u62E9\u4EA7\u54C1",modelValue:e(A),"onUpdate:modelValue":$[2]||($[2]=Z=>ce(A)?A.value=Z:null),width:"1200px",onClose:E,"close-on-click-modal":!1,"append-to-body":""},{default:p(()=>[l("div",Rt,[l("div",Lt,[a(W,{data:e(g),"node-key":"productClassifyId","default-expand-all":"",props:s,onNodeClick:r},null,8,["data"])]),a(M,{direction:"vertical",style:{height:"100%"}}),l("div",Ot,[l("div",Ut,[l("span",null,[zt,l("span",jt,N(c.selectList.length),1),Jt]),a(G,{style:{width:"180px"},modelValue:e(D).keyWords,"onUpdate:modelValue":$[0]||($[0]=Z=>e(D).keyWords=Z),onBlur:e(h),placeholder:"\u4EA7\u54C1\u540D\u79F0/\u7F16\u53F7"},null,8,["modelValue","onBlur"])]),a(t,{ref_key:"tableRef",ref:n,comheight:460,isBorder:!0,isSelection:!0,isIndex:!1,isPagination:!0,isShowPageBtn:!1,loading:!1,isHandle:!0,tableData:e(S),tableCols:e(R),onSelectChage:e(k),pagination:e(_),onRefresh:e(h),headerStyle:{background:"rgb(245 245 245)",color:"#666666",fontSize:"14px",fontWeight:700,height:"49px"}},null,8,["tableData","tableCols","onSelectChage","pagination","onRefresh","headerStyle"])])]),l("div",Wt,[a(i,{type:"primary",onClick:$[1]||($[1]=Z=>o())},{default:p(()=>[Mt]),_:1})])]),_:1},8,["modelValue"])):L("",!0),a(Ae,{ref_key:"confirmQuotationRef",ref:u,onSuccess:e(F),onBack:e(B),row:d.row},null,8,["onSuccess","onBack","row"])],64)}}});var qt=de(Qt,[["__scopeId","data-v-0ee88f88"]]);const Ht={class:"flexBetween",style:{"margin-bottom":"20px"}},Kt=l("div",null,"\u4EA7\u54C1\u62A5\u4EF7",-1),Xt={class:"flexStart right_box"},Gt=I(" \u62A5\u4EF7\u8BB0\u5F55\u6570\u91CF: "),Yt=I(" \u4EA7\u54C1\u603B\u6570\u91CF: "),Zt=I(" \u4EA7\u54C1\u603B\u91D1\u989D: "),ea=I(" \u6574\u5355\u6298\u6263\u7387: "),ta=I(" \u62A5\u4EF7\u603B\u91D1\u989D: "),aa={class:"right_box2"},la=I("\u7F16\u8F91\u62A5\u4EF7"),oa=I("\u65B0\u5EFA"),na=Q({__name:"index",props:{row:{type:Object,default:{}}},emits:["success"],setup(b,{emit:v}){const w=b;ae(),le(),q();const d=z(null),s=z(null),u=ye("reloadFn"),n=H({searchData:{},showData:{},checked1:!1,tableCols:[{label:"\u4EA7\u54C1\u540D\u79F0",prop:"productName"},{label:"\u4EA7\u54C1\u7F16\u53F7",prop:"productId"},{label:"\u6807\u51C6\u5355\u4EF7",prop:"standardPrice"},{label:"\u5B9E\u9645\u552E\u4EF7",prop:"salePrice"},{label:"\u6570\u91CF",prop:"saleNumber"},{label:"\u6298\u6263\u7387(%)",prop:"discount"},{label:"\u603B\u4EF7",prop:"totalPrice"},{label:"\u4EA7\u54C1\u89C4\u683C",prop:"productSpecification"},{label:"\u793C\u54C1",prop:"gift"},{label:"\u5907\u6CE8",prop:"remark"},{label:"\u64CD\u4F5C",type:"Button",width:"100px",btnList:[{type:"danger",label:"\u5220\u9664",size:"small",handle:(C,k)=>P(C)}]}],tableData:[],pagination:{pageSize:10,pageIndex:1,total:0}}),{searchData:c,showData:S,tableData:R,tableCols:A}=K(n),D=()=>{d.value.init()};let _=()=>{s.value.init("edit",n.tableData)},g=()=>{u()},P=(C,k)=>{pe.confirm("\u8BE5\u6570\u636E\u5C06\u6C38\u4E45\u88AB\u5220\u9664\uFF0C\u5E76\u4E14\u65E0\u6CD5\u6062\u590D\u3002\u786E\u5B9A\u5220\u9664\u5417\uFF1F","\u63D0\u793A").then(async()=>{var F;try{await((F=te)==null?void 0:F.delBusProduct(C.businessProductId)),Y.success("\u5220\u9664\u6210\u529F"),m()}catch{}}).catch(()=>{})};X(()=>{m()});const m=async()=>{var k,F,B,h,r;let C=null;try{let o=JSON.parse(JSON.stringify(n.searchData));o.current=n.pagination.pageIndex,o.size=n.pagination.pageSize,C=await te.productQuote(w.row.businessId),n.tableData=((B=(F=(k=C.data)==null?void 0:k.productPriceVOS)==null?void 0:F.records)==null?void 0:B.map(E=>J(U({},E),{salePrice:E.salePrice||"0",saleNumber:E.saleNumber||"0",discount:E.discount||"0",totalPrice:E.totalPrice||"0",productSpecification:findLabel(re,E.productSpecification)})))||[],n.showData=C.data,n.pagination.total=((r=(h=C.data)==null?void 0:h.productPriceVOS)==null?void 0:r.total)||0}catch{n.tableData=[]}};return(C,k)=>{const F=x("el-button"),B=x("TableTemp");return f(),V("div",null,[l("div",Ht,[Kt,l("div",Xt,[l("div",null,[Gt,l("span",null,N(e(S).productRecordNumber||0)+" \u6761",1)]),l("div",null,[Yt,l("span",null,N(e(S).totalNumberOfProducts||0)+" \u4E2A",1)]),l("div",null,[Zt,l("span",null,"\xA5 "+N(e(S).totalProductAmount||0),1)]),l("div",null,[ea,l("span",null,N(e(S).wholeOrderDiscount||0)+" %",1)]),l("div",null,[ta,l("span",null,"\xA5 "+N(e(S).totalAmountQuoted||0),1)]),l("div",aa,[e(R).length?(f(),O(F,{key:0,type:"primary",icon:"Edit",onClick:k[0]||(k[0]=h=>e(_)())},{default:p(()=>[la]),_:1})):(f(),O(F,{key:1,type:"primary",icon:"Plus",onClick:k[1]||(k[1]=h=>D())},{default:p(()=>[oa]),_:1}))])])]),a(B,{comheight:360,isBorder:!0,isSelection:!1,isIndex:!0,isPagination:!1,loading:!1,isHandle:!0,tableData:e(R),tableCols:e(A),onRefresh:e(g),headerStyle:{background:"rgb(245 245 245)",color:"#666666",fontSize:"14px",fontWeight:700,height:"49px"}},null,8,["tableData","tableCols","onRefresh","headerStyle"]),a(qt,{ref_key:"seleProductRef",ref:d,onSuccess:e(g),row:w.row},null,8,["onSuccess","row"]),a(Ae,{ref_key:"confirmQuotationRef",ref:s,onSuccess:e(g),row:w.row},null,8,["onSuccess","row"])])}}});const sa={class:"flexStart"},ua=Q({__name:"index",props:{row:{type:Object,default:{}}},emits:["success"],setup(b,{expose:v,emit:w}){const d=b;ae(),le(),q();const s=H({searchData:{startDate:"",endDate:"",keyWords:""},checked1:!1,tableData:[],clientId:"",pagination:{pageSize:10,pageIndex:1,total:0}}),{searchData:u,checked1:n,tableData:c,pagination:S}=K(s);let R=async(D={})=>{};X(()=>{A()});const A=()=>{let D=d.row.clientId;Ge.client({current:s.pagination.pageIndex,size:s.pagination.pageSize,clientId:D,followUpWhether:null}).then(_=>{s.tableData=_.data.records.map(g=>J(U({},g),{followContent:g.details,creatorName:g.userName})),s.pagination.total=_.data.total||0})};return v({init:R}),(D,_)=>{const g=x("DateRangeCom"),P=x("el-input");return f(),V("div",null,[a(me,{style:{height:"730px"},title:" ",tableData:e(c),pagination:e(S),fileDownType:"sendDetail",searchData:e(u),onSuccess:A},{default:p(()=>[l("div",sa,[a(g,{starTime:e(u).startDate,"onUpdate:starTime":_[0]||(_[0]=m=>e(u).startDate=m),endTime:e(u).endDate,"onUpdate:endTime":_[1]||(_[1]=m=>e(u).endDate=m),width:"220px",style:{"margin-right":"10px"},onChange:A},null,8,["starTime","endTime"]),a(P,{style:{"margin-right":"10px",width:"200px"},modelValue:e(u).keyWords,"onUpdate:modelValue":_[2]||(_[2]=m=>e(u).keyWords=m),placeholder:"\u641C\u7D22\u5173\u952E\u5B57",onBlur:A},null,8,["modelValue"])])]),_:1},8,["tableData","pagination","searchData"])])}}});const se=b=>(ve("data-v-94581dd6"),b=b(),Fe(),b),ia={key:0,class:"main",style:{position:"relative"}},ra={class:"flexBetween marginB10"},da={class:"el-descriptions__title"},ca={class:"flexStart detail_tit"},pa={class:"marginR30"},ma={class:"marginR30"},_a={class:"marginR30"},fa={class:"marginB20 flexStart"},ba=I("\u5199\u65B0\u8DDF\u8FDB"),ga=I("\u65B0\u5EFA\u4EFB\u52A1"),ha=I("\u8F6C\u4E3A\u8BA2\u5355"),ya=I("\u6DFB\u52A0\u534F\u4F5C"),Da=I("\u7F16\u8F91\u5546\u673A"),xa=I("\u5220\u9664\u5546\u673A"),va={class:"step flexBetween marginB20"},Fa=["onClick"],wa=se(()=>l("span",{class:"sjx"},null,-1)),Ca=se(()=>l("span",{class:"sjx"},null,-1)),Aa=se(()=>l("span",{class:"sjx"},null,-1)),Sa=se(()=>l("span",{class:"sjx"},null,-1)),ka=Q({__name:"index",setup(b){const v=ae(),w=le();q();const d=H({activeName:"1",formData:{},list:[{label:"\u6982\u51B5\u4FE1\u606F",value:"1"},{label:"\u8054\u7CFB\u4EBA",value:"2"},{label:"\u8DDF\u8FDB\u8BB0\u5F55",value:"3"},{label:"\u5173\u8054\u8BA2\u5355",value:"5"},{label:"\u4EA7\u54C1\u62A5\u4EF7",value:"6"},{label:"\u5546\u673A\u52A8\u6001",value:"8"}],options:[],reload:!0}),{activeName:s,list:u,formData:n,reload:c}=K(d),S=z(null),R=z(null),A=z(null),D=z(null),_=z(null),g=z(null),P=z(null),m=z(null),C=z(null),k=(t,i)=>{d.activeName=t.props.name};Je(()=>{B()});const F=()=>{d.reload=!1,we(()=>{d.reload=!0}),B()};We("reloadFn",F);let B=()=>{let t=w.query.businessId;te.businessDetail(t).then(i=>{Object.assign(d.formData,U({},i.data))}).catch(i=>console.log(i))},h=()=>{var t;(t=_==null?void 0:_.value)==null||t.init("add2",{clientName:d.formData.clientName,clientId:d.formData.clientId,businessId:d.formData.businessId,businessTitle:d.formData.businessTitle})},r=()=>{var t;(t=D==null?void 0:D.value)==null||t.init("",d.formData.clientId)};const o=()=>{var t;(t=R==null?void 0:R.value)==null||t.init("edit",d.formData)},E=t=>{var i,j;t==1?(i=S==null?void 0:S.value)==null||i.init("business",d.formData):t==2||t==3&&((j=m==null?void 0:m.value)==null||j.init("add",J(U({},d.formData),{relatedBusiness:"2",relatedBusinessName:"\u5546\u673A",businessId:d.formData.businessId,businessName:d.formData.businessTitle})))},T=()=>{M(4)},$=()=>{console.log("cancel!"),M(2)},W=t=>{d.formData.salesStage==4||d.formData.salesStage==2||d.formData.salesStage!=t&&ie.switch(d.formData.businessId,t).then(i=>{B(),Y.success("\u64CD\u4F5C\u6210\u529F")}).catch(()=>{B()})},M=t=>{ie.switch(d.formData.businessId,t).then(i=>{B(),Y.success("\u64CD\u4F5C\u6210\u529F")}).catch(()=>{B()})},G=()=>{pe.confirm("\u5C06\u6C38\u4E45\u88AB\u5220\u9664\uFF0C\u5E76\u4E14\u65E0\u6CD5\u6062\u590D\u3002","\u786E\u5B9A\u5220\u9664\u5417\uFF1F").then(()=>{var t;(t=ie)==null||t.del(d.formData.businessId).then(i=>{Y.success("\u5220\u9664\u6210\u529F"),v.go(-1)})}).catch(()=>{})};return(t,i)=>{const j=x("el-button"),Z=x("el-popconfirm"),Se=x("el-tab-pane"),ke=x("el-tabs"),Be=x("el-card");return e(c)?(f(),V("div",ia,[a(Be,{id:"content_box",shadow:"never"},{default:p(()=>[l("div",ra,[l("div",da,N(e(n).businessTitle),1)]),l("div",ca,[l("div",pa,"\u5173\u8054\u5BA2\u6237\uFF1A"+N(e(n).clientName||"-"),1),l("div",ma," \u4E3B\u8981\u8054\u7CFB\u4EBA\uFF1A"+N(e(n).contactName||"-"),1),l("div",_a," \u4E0B\u6B21\u8DDF\u8FDB\uFF1A"+N(e(n).nextFollowTime||"-"),1)]),l("div",fa,[a(j,{onClick:i[0]||(i[0]=y=>E(1))},{default:p(()=>[ba]),_:1}),a(j,{onClick:i[1]||(i[1]=y=>E(3))},{default:p(()=>[ga]),_:1}),a(j,{onClick:i[2]||(i[2]=y=>e(h)())},{default:p(()=>[ha]),_:1}),a(j,{onClick:i[3]||(i[3]=y=>e(r)())},{default:p(()=>[ya]),_:1}),a(j,{onClick:i[4]||(i[4]=y=>o())},{default:p(()=>[Da]),_:1}),a(j,{onClick:i[5]||(i[5]=y=>G()),icon:"Delete"},{default:p(()=>[xa]),_:1})]),l("div",va,[(f(!0),V(ee,null,ne(e(De),(y,ue)=>(f(),V(ee,{key:ue},[y.value!=4&&y.value!=2?(f(),V("div",{key:0,class:oe(e(n).salesStage==y.value?"active  div":""),style:Me({cursor:e(n).salesStage==4||e(n).salesStage==2?"default":""}),onClick:Ba=>W(y.value)},[l("span",null,N(y.label),1),wa],14,Fa)):L("",!0),y.value==4&&e(n).salesStage!=2&&e(n).salesStage!=4?(f(),O(Z,{key:1,"confirm-button-text":"\u6210\u4EA4\u5546\u673A","cancel-button-text":"\u6D41\u5931\u5546\u673A","icon-color":"#626AEF",title:"\u66F4\u6539\u5546\u673A\u9636\u6BB5",onConfirm:T,onCancel:$},{reference:p(()=>[l("div",{class:oe(e(n).salesStage==y.value?"div active activeSuccess":"")},[l("span",null,N(y.label),1),Ca],2)]),_:2},1024)):L("",!0),y.value==4&&e(n).salesStage==4?(f(),V("div",{key:2,class:oe(e(n).salesStage==y.value?"div active activeSuccess":"")},[l("span",null,N(y.label),1),Aa],2)):L("",!0),y.value==2&&e(n).salesStage==2?(f(),V("div",{key:3,class:oe(e(n).salesStage==y.value?"div active activeCancel":"")},[l("span",null,N(y.label),1),Sa],2)):L("",!0)],64))),128))]),a(ke,{modelValue:e(s),"onUpdate:modelValue":i[6]||(i[6]=y=>ce(s)?s.value=y:null),onTabClick:k,type:"border-card"},{default:p(()=>[(f(!0),V(ee,null,ne(e(u),(y,ue)=>(f(),O(Se,{label:y.label,key:ue,name:y.value},{default:p(()=>[e(s)=="1"&&y.value=="1"?(f(),O(ct,{key:0,row:e(n)},null,8,["row"])):L("",!0),e(s)=="2"&&y.value=="2"?(f(),O(pt,{key:1,row:e(n)},null,8,["row"])):L("",!0),e(s)=="3"&&y.value=="3"?(f(),O(_t,{key:2,row:e(n)},null,8,["row"])):L("",!0),e(s)=="4"&&y.value=="4"?(f(),O(ft,{key:3,row:e(n)},null,8,["row"])):L("",!0),e(s)=="5"&&y.value=="5"?(f(),O(gt,{key:4,row:e(n)},null,8,["row"])):L("",!0),e(s)=="6"&&y.value=="6"?(f(),O(na,{key:5,row:e(n)},null,8,["row"])):L("",!0),e(s)=="8"&&y.value=="8"?(f(),O(ua,{key:6,row:e(n)},null,8,["row"])):L("",!0)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"]),a(qe,{ref_key:"SJAddRefs",ref:R,onSuccess:F},null,512),a(Qe,{ref_key:"followTaskRef",ref:S,onSuccess:F},null,512),a(He,{ref_key:"LXRAddRef",ref:A,onSuccess:F},null,512),a(et,{ref_key:"addCooperationRef",ref:D,onSuccess:F},null,512),a(tt,{ref_key:"orderAddRef",ref:_,onSuccess:F},null,512),a(Ke,{ref_key:"convert2CustomerRef",ref:g,onSuccess:F},null,512),a(Xe,{ref_key:"XSaddRef",ref:P,onSuccess:F},null,512),a(Ye,{ref_key:"addTaskRef",ref:m},null,512),a(Ze,{ref_key:"addTaskRef2",ref:C},null,512)]),_:1})])):L("",!0)}}});var qa=de(ka,[["__scopeId","data-v-94581dd6"]]);export{qa as default};
