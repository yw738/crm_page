var V=Object.defineProperty,X=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var y=(n,u,a)=>u in n?V(n,u,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[u]=a,F=(n,u)=>{for(var a in u||(u={}))G.call(u,a)&&y(n,a,u[a]);if(g)for(var a of g(u))J.call(u,a)&&y(n,a,u[a]);return n},C=(n,u)=>X(n,$(u));import{U as K}from"./index.72de21bc.js";import{_ as Q,d as Y,q as Z,r,ad as ee,L as te,X as le,ae,a1 as f,M as ue,o as oe,$ as ne,af as se,E,a0 as D,a as re,b as ie,f as ce,x as i,h as p}from"./index.052afee0.js";import{T as pe}from"./TransferUser.6bd2da35.js";import{A as de}from"./AddTask.93499407.js";import{F as he}from"./FollowTask.dc6c96ed.js";import{A as me}from"./add.4a77b86a.js";import{C as Fe}from"./Convert2Customer.b2715b9e.js";import{D as fe}from"./DiversionClue.c9fa8faa.js";import"./index.4950eb20.js";const De={class:"content_box"},Ee=Y({__name:"index",emits:["openApp"],setup(n,{emit:u}){const{user:a}=Z(),d=r(null);let _=e=>{var t;(t=d==null?void 0:d.value)==null||t.init()};ee("calsType","crm:clue:query:highSeas");const o=te({searchData:{keyWords:null,clientSource:null,clientHighType:null,oldBelongUserId:null,intoThePoolStartDate:null,intoThePoolEndDate:null,isTopSort:!0},selectList:[],requestData:{companyId:a.userInfo.companyId},searchForm:[{type:"input",prop:"keyWords",width:"180px",placeholder:"\u641C\u7D22\u5173\u952E\u5B57",change:()=>{}},{type:"select",prop:"clientSource",placeholder:"\u7EBF\u7D22\u6765\u6E90",width:"180px",options:le,change:()=>{}},{type:"select",prop:"clientHighType",placeholder:"\u7EBF\u7D22\u7C7B\u578B",width:"180px",options:ae,change:()=>{}},{type:"select",prop:"oldBelongUserId",placeholder:"\u524D\u5F52\u5C5E\u4EBA",width:"180px",options:[],change:()=>{}},{type:"daterange",prop:"intoThePoolStartDate",prop2:"intoThePoolEndDate",placeholder:"\u5165\u6C60\u65F6\u95F4",change:()=>{}}],searchHandle:[{label:"\u67E5\u8BE2",type:"primary",icon:"Search",handle:()=>q()},{label:"\u91CD\u7F6E",handle:()=>z()}],tableHandles:[{label:"\u6DFB\u52A0",type:"primary",icon:"Plus",handle:()=>N()},{label:"\u5BFC\u5165",icon:"Upload",handle:e=>_()},{label:"\u5BFC\u51FA",icon:"Download",handle:()=>H()},{label:"\u9886\u53D6\u7EBF\u7D22",handle:()=>R()},{label:"\u5206\u914D\u7EBF\u7D22",handle:()=>M()}],tableCols:[{label:"\u64CD\u4F5C",type:"Button",width:"340px",btnList:[{type:"primary",label:"\u7F16\u8F91",icon:"Edit",size:"small",isShow:()=>a.userLevel==2,handle:(e,t)=>W(e)},{type:"primary",label:"\u7F6E\u9876",size:"small",icon:"SortUp",handle:(e,t)=>U(e)},{type:"danger",label:"\u5220\u9664",icon:"Delete",size:"small",isShow:()=>a.userLevel==2,handle:(e,t)=>j(e)}]}],tableData:[{}],appTableData:[],pagination:{pageSize:10,pageIndex:1,total:0},treeData:[],allList:[],getApi:f.getList2}),{searchData:B,searchForm:T,searchHandle:ge,tableHandles:b,tableCols:S,pagination:v,getApi:A}=ue(o),h=r(),c=r(null),x=r(null),k=r(null),w=r(null),I=r(null),m=r(null),L=e=>C(F({},e),{intoThePoolStartDate:e.intoThePoolStartDate.split(" ")[0],intoThePoolEndDate:e.intoThePoolEndDate.split(" ")[0]});oe(()=>{ne.queryEmployee().then(e=>{var t;o.searchForm[3].options=(t=e.data)==null?void 0:t.map(l=>({label:l.name,value:l.id,departmentId:l.departmentId}))}),se("crm:clue:query:highSeas").then(e=>{o.tableCols=[...e,...o.tableCols]})});let P=e=>{o.selectList=e.selection},H=()=>{window.fileDown("commonClue",F({},o.searchData))},U=(e,t)=>{E.confirm("\u8BE5\u64CD\u4F5C\u5C06\u7F6E\u9876\u3002","\u786E\u5B9A\u7F6E\u9876\u5417\uFF1F").then(()=>{var l;(l=f)==null||l.top(e.clientId).then(O=>{D.success("\u7F6E\u9876\u6210\u529F"),s()})}).catch(()=>{})},R=()=>{let e=o.selectList.map(t=>t.clientId).join(",");if(!e){D.error("\u9886\u53D6\u7EBF\u7D22\u81F3\u5C11\u9700\u9009\u62E91\u6761\u6570\u636E\uFF1B");return}E.confirm("\u662F\u5426\u786E\u8BA4\u9886\u53D6\u6240\u9009\u62E9\u7684\u7EBF\u7D22\uFF1F\u9886\u53D6\u540EN\u5929\u540E\u672A\u8DDF\u8FDB\uFF0C\u7EBF\u7D22\u5C06\u81EA\u52A8\u8F6C\u4E3A\u516C\u5171\u7EBF\u7D22","\u786E\u8BA4\u63D0\u793A").then(()=>{var t;(t=f)==null||t.receiveClue(e).then(l=>{D.success("\u64CD\u4F5C\u6210\u529F"),s()})}).catch(()=>{})};const q=()=>{o.pagination.pageIndex=1,s()},z=()=>{Object.assign(o.searchData,{keyWords:null,clientSource:null,clientHighType:null,oldBelongUserId:null,intoThePoolStartDate:null,intoThePoolEndDate:null,isTopSort:!0})};let M=()=>{var t;let e=o.selectList.map(l=>l.clientId);(t=m==null?void 0:m.value)==null||t.init(e)},N=()=>{var e;(e=c==null?void 0:c.value)==null||e.init("add",{clueType:"1",customerType:"4"})},W=(e,t)=>{var l;(l=c==null?void 0:c.value)==null||l.init("edit",F({clueType:"1",customerType:"4"},e))},j=(e,t)=>{E.confirm("\u8BE5\u6570\u636E\u5C06\u6C38\u4E45\u88AB\u5220\u9664\uFF0C\u5E76\u4E14\u65E0\u6CD5\u6062\u590D\u3002\u786E\u5B9A\u5220\u9664\u5417\uFF1F","\u63D0\u793A").then(()=>{var l;(l=f)==null||l.del(e.clientId).then(O=>{D.success("\u5220\u9664\u6210\u529F"),s()})}).catch(()=>{})};const s=()=>{var e;o.selectList=[],(e=h==null?void 0:h.value)==null||e.getList()};return(e,t)=>{const l=re("PageLayout");return ie(),ce("div",De,[i(l,{ref_key:"pageLayout",ref:h,isSelection:!0,isIndex:!1,isShowPageBtn:!1,tableBtnIsTopRight:!1,searchForm:p(T),searchData:p(B),tableHandles:p(b),tableCols:p(S),pagination:p(v),api:p(A),requestFormmter:L,onSelectChage:p(P)},null,8,["searchForm","searchData","tableHandles","tableCols","pagination","api","onSelectChage"]),i(pe,{ref_key:"transferUserRef",ref:x},null,512),i(de,{ref_key:"addTaskRef",ref:k},null,512),i(he,{ref_key:"followTaskRef",ref:w},null,512),i(me,{ref_key:"addRef",ref:c,onSuccess:s},null,512),i(Fe,{ref_key:"convert2CustomerRef",ref:I,onSuccess:s},null,512),i(fe,{ref_key:"diversionClueRef",ref:m,onSuccess:s},null,512),i(K,{ref_key:"uploadFileRef",ref:d,typeName:"cluePublic",onSuccess:s},null,512)])}}});var ke=Q(Ee,[["__scopeId","data-v-cc8e9564"]]);export{ke as default};
