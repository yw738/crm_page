import{_ as T,d as w,q as R,r as j,V as h,L as N,M as z,a as c,h as o,b as g,c as y,e as s,m as q,x as r,f as O,g as S,F as J,U as L,y as M,G as I,a0 as f,$ as m}from"./index.6f18bade.js";const G=I(" *\u8F6C\u79FB\u540E\u5BA2\u6237\u8DDF\u8FDB\u3001\u5546\u673A\u3001\u8BA2\u5355\u5C06\u4E00\u8D77\u8F6C\u79FB\u7ED9\u63A5\u6536\u5BF9\u8C61 "),$={class:"dialog-footer",style:{"text-align":"center"}},H=I("\u786E\u5B9A"),K=I("\u53D6\u6D88"),P=w({__name:"TransferUser",emits:["success"],setup(Q,{expose:D,emit:_}){R();const v=j(h),e=N({visible:!1,formData:{clientId:"",reciveUserId:"",departmentId:""},rules:{reciveUserId:[{required:!0,message:"\u8BF7\u9009\u62E9",trigger:"blur"}]},options:[],openType:"",oldRes:null,title:""}),{visible:p,formData:F,rules:b,options:x,title:B}=z(e);let U=async(t={},l="client")=>{if(!(t!=null&&t.length)){f.error("\u5206\u914D\u5BA2\u6237\u81F3\u5C11\u9700\u9009\u62E91\u6761\u6570\u636E");return}l=="client"?e.title="\u5206\u914D\u5BA2\u6237":l=="laji"?e.title="\u5206\u914D\u8D44\u6E90":l=="zhaunyi"&&(e.title="\u8F6C\u79FB\u5BA2\u6237"),await m.queryEmployee().then(a=>{var n;e.options=(n=a.data)==null?void 0:n.map(i=>({label:i.name,value:i.id,departmentId:i.departmentId}))}).catch(a=>console.log(a)),e.openType=l,l=="client"?e.formData.clientId=t:l=="laji"?(e.formData.clientId=t.map(a=>a.clientId).join(","),e.oldRes=t):e.formData.clientId=t,e.visible=!0};async function E(){var l;let t=JSON.parse(JSON.stringify(e.formData));if(typeof t.clientId=="string"&&(t.clientId=t.clientId.split(",")),e.openType=="client")m.assignClient(t).then(()=>{f.success("\u64CD\u4F5C\u6210\u529F\uFF01"),d(),_("success")});else if(e.openType=="laji"){let a=(l=e.oldRes)==null?void 0:l.map(n=>({clientId:n.clientId,belongUserId:t.reciveUserId,departmentId:t.departmentId,distinuish:n.clientDistinguish}));m.recycleAllocation(a).then(()=>{f.success("\u64CD\u4F5C\u6210\u529F\uFF01"),d(),_("success")})}else e.openType=="zhaunyi"&&m.shiftClient(t).then(()=>{f.success("\u64CD\u4F5C\u6210\u529F\uFF01"),d(),_("success")})}function A(t){var a;let l=((a=e.options)==null?void 0:a.find(n=>n.value==t))||{};e.formData.departmentId=l.departmentId}function V(){v.value.validate(t=>{t&&E()})}function d(){v.value.resetFields(),e.visible=!1,Object.assign(e.formData,{clientId:"",reciveUserId:"",departmentId:""})}return D({init:U}),(t,l)=>{const a=c("el-option"),n=c("el-select"),i=c("el-form-item"),C=c("el-button"),k=c("el-dialog");return o(p)?(g(),y(k,{key:0,title:o(B),modelValue:o(p),"onUpdate:modelValue":l[1]||(l[1]=u=>L(p)?p.value=u:null),width:"500px",onClose:d,"close-on-click-modal":!1,"append-to-body":""},{footer:s(()=>[q("div",$,[r(C,{type:"primary",onClick:V},{default:s(()=>[H]),_:1}),r(C,{onClick:d},{default:s(()=>[K]),_:1})])]),default:s(()=>[r(o(h),{ref_key:"dataFormRef",ref:v,model:o(F),rules:o(b),"label-width":"100px"},{default:s(()=>[r(i,{label:"\u63A5\u6536\u5BF9\u8C61:",prop:"reciveUserId"},{default:s(()=>[r(n,{modelValue:o(F).reciveUserId,"onUpdate:modelValue":l[0]||(l[0]=u=>o(F).reciveUserId=u),style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9",onChange:A},{default:s(()=>[(g(!0),O(J,null,S(o(x),u=>(g(),y(a,{key:u.value,label:u.label,value:u.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(i,null,{default:s(()=>[G]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])):M("",!0)}}});var X=T(P,[["__scopeId","data-v-78726872"]]);export{X as T};
