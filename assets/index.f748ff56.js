var ae=Object.defineProperty,te=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var R=(o,u,e)=>u in o?ae(o,u,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[u]=e,g=(o,u)=>{for(var e in u||(u={}))ue.call(u,e)&&R(o,e,u[e]);if(J)for(var e of J(u))re.call(u,e)&&R(o,e,u[e]);return o},x=(o,u)=>te(o,le(u));import{s as Y,c as se}from"./index.d8485059.js";import{r as ne,i as oe}from"./resize.e295f582.js";import{d as P,w as de,K as $,B as ie,R as ce,S as pe,A as me,b as c,f as b,n as fe,J as _e,_ as he,L as q,M as G,o as K,a as h,az as be,m as I,x as d,e as i,c as D,h as l,U as Q,F,g as w,t as j,H as ye,G as z,y as De}from"./index.052afee0.js";const Ce=["id"],ve=P({__name:"PieChart",props:{id:{type:String,default:"pieChart5"},className:{type:String,default:""},width:{type:String,default:"100%",required:!0},height:{type:String,default:"100%",required:!0},data:{type:Object,default:()=>({})}},setup(o){const u=o,{mounted:e,chart:f,beforeDestroy:V,activated:E,deactivated:C}=ne();function A(){const _=oe(document.getElementById(u.id));let{arr1:p=[],arr2:B=[],xAxis:N=[],label:L=[]}=u.data,S=(p==null?void 0:p.sort((U,T)=>T-U)[0])||1e4,O=Math.ceil(Number(S/5));_.setOption({grid:{left:"2%",top:"2%",right:"2%",bottom:"10%",containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}}},xAxis:[{type:"category",data:N,axisPointer:{type:"shadow"}}],yAxis:[{type:"value",min:0,max:S,interval:O,axisLabel:{formatter:"{value} "}},{type:"value",min:0,max:100,interval:20,axisLabel:{formatter:"{value}%"}}],series:[{name:L[0],type:"bar",data:p,barWidth:20,itemStyle:{color:"#3aa1ff"}}]}),f.value=_}return de(()=>u.data,()=>{$(()=>{A()})}),ie(()=>{V()}),ce(()=>{E()}),pe(()=>{C()}),me(()=>{e();let _=null;_=setInterval(()=>{var p;(p=u.data)!=null&&p.xAxis&&$(()=>{A(),clearInterval(_)})},100)}),(_,p)=>(c(),b("div",{id:o.id,class:fe(o.className),style:_e({height:o.height,width:o.width})},null,14,Ce))}});const ge=z("\u67E5\u8BE2"),xe=z("\u91CD\u7F6E"),Ie={class:"marginB20 marginT20"},Ee={class:"flexBetween marginB10"},Ae={class:"tab_head"},Fe=z("\u5BFC\u51FA"),Ve=P({__name:"index",props:{activeName:{type:String}},setup(o){const u=o,e=q({date:[],searchData:{startDate:"",endDate:"",departmentId:"",userId:"",productClassifyId:"",productId:"",year:""},tableHandles:[],tableCols:[{label:"\u4EA7\u54C1\u540D\u79F0",prop:"productName"},{label:"\u4EA7\u54C1\u7F16\u53F7",prop:"productNumber"},{label:"\u9500\u552E\u6570\u91CF",prop:"salesVolume"},{label:"\u9500\u552E\u91D1\u989D",prop:"salesAmount"},{label:"\u5E73\u5747\u5355\u4EF7",prop:"theAverageUnitPrice"}],tableData:[],chartData:[],userId:[],departmentId:[],tabData:{},productClassifyId:[],productId:[]}),{searchData:f,departmentId:V,userId:E,tableHandles:C,tableCols:A,tableData:_,chartData:p,tabData:B,date:N,productClassifyId:L,productId:S}=G(e);function O(r){var s;e.searchData.productId="";let a=((s=e.productClassifyId)==null?void 0:s.find(n=>n.value==r))||{};e.productId=a.relatedProductBOS||[]}function U(r){var s;e.searchData.userId="";let a=((s=e.departmentId)==null?void 0:s.find(n=>n.value==r))||{};e.userId=a.persons||[]}function T(r){r&&(r==null?void 0:r.length)?(e.searchData.startDate=r[0],e.searchData.endDate=r[1]):(e.searchData.startDate="",e.searchData.endDate="")}K(async()=>{let{activeName:r}=u;r=="2"?e.tableCols=[{label:"\u5206\u7C7B\u540D\u79F0",prop:"productName"},{label:"\u9500\u552E\u6570\u91CF",prop:"salesVolume"},{label:"\u9500\u552E\u91D1\u989D",prop:"salesAmount"},{label:"\u5E73\u5747\u5355\u4EF7",prop:"theAverageUnitPrice"}]:r=="3"&&(Y.productList().then(s=>{var n;e.productClassifyId=((n=s==null?void 0:s.data)==null?void 0:n.map(m=>x(g({},m),{label:m.classifyName,value:m.productClassifyId})))||[]}),e.tableCols=[{label:"\u65F6\u95F4",prop:"time"},{label:"\u9500\u552E\u6570\u91CF",prop:"salesVolume"},{label:"\u9500\u552E\u91D1\u989D",prop:"salesAmount"},{label:"\u9500\u552E\u989D\u540C\u6BD4\u589E\u957F",prop:"salesQuarter"}],e.searchData.year="2023");let a=getYear();e.searchData.startDate=a[0],e.searchData.endDate=a[1],e.date=a,se.departmentList().then(s=>{var n;e.departmentId=((n=s==null?void 0:s.data)==null?void 0:n.map(m=>x(g({},m),{label:m.departmentName,value:m.departmentId})))||[]}),H()});let W=()=>{let{activeName:r}=u,a=JSON.parse(JSON.stringify(e.searchData));r=="1"?window.fileDown("productSummary",x(g({},a),{type:0}),"\u4EA7\u54C1\u9500\u91CF\u5206\u6790-\u6309\u4EA7\u54C1\u6C47\u603B\u5BFC\u51FA"):r=="2"?window.fileDown("productSummary",x(g({},a),{type:1}),"\u4EA7\u54C1\u9500\u91CF\u5206\u6790-\u6309\u5206\u7C7B\u6C47\u603B\u5BFC\u51FA"):window.fileDown("summaryTime",e.searchData)};const X=()=>{Object.assign(e.searchData,{startDate:"",endDate:"",departmentId:"",userId:"",productClassifyId:"",productId:"",year:""}),e.userId=[]},Z=()=>{H()},H=async()=>{let r=null;try{let a=JSON.parse(JSON.stringify(e.searchData)),{activeName:s}=u;s=="1"?r=await Y.getList(x(g({},a),{type:0})):s=="2"?r=await Y.getList(x(g({},a),{type:1})):(delete a.startDate,delete a.endDate,r=await Y.getList2(a));let n=[],m=[],y,k;s=="1"||s=="2"?(e.tableData=r.data.productListVOS||[],r.data.productHistogramVOS.forEach(v=>{n.push(v.salesAmount||0),m.push(v.productName||0)}),y="\u9500\u552E\u91D1\u989D"):(e.tableData=r.data.productListVOS||[],r.data.productHistogramVOS.forEach(v=>{n.push(v.salesAmount||0),m.push(v.time||0)}),y="\u9500\u552E\u91D1\u989D"),e.chartData={arr1:n,xAxis:m,label:[y]},e.tabData=r.data}catch{e.tableData=[]}};return(r,a)=>{const s=h("el-date-picker"),n=h("el-form-item"),m=h("el-option"),y=h("el-select"),k=h("el-button"),M=h("el-form"),v=h("TableTemp"),ee=be("has-perm");return c(),b("div",null,[I("div",null,[d(M,{inline:!0,model:l(f),"label-width":"150px"},{default:i(()=>[u.activeName!="3"?(c(),D(n,{key:0},{default:i(()=>[d(s,{style:{width:"220px"},onChange:T,modelValue:l(N),"onUpdate:modelValue":a[0]||(a[0]=t=>Q(N)?N.value=t:null),format:"YYYY-MM","value-format":"YYYY-MM-DD",type:"monthrange","range-separator":"~","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F"},null,8,["modelValue"])]),_:1})):(c(),b(F,{key:1},[d(n,null,{default:i(()=>[d(s,{"value-format":"YYYY",format:"YYYY",clearable:!1,modelValue:l(f).year,"onUpdate:modelValue":a[1]||(a[1]=t=>l(f).year=t),type:"year"},null,8,["modelValue"])]),_:1}),d(n,null,{default:i(()=>[d(y,{modelValue:l(f).productClassifyId,"onUpdate:modelValue":a[2]||(a[2]=t=>l(f).productClassifyId=t),placeholder:"\u4EA7\u54C1\u5206\u7C7B",onChange:O},{default:i(()=>[(c(!0),b(F,null,w(l(L),t=>(c(),D(m,{label:t.label,value:t.value,key:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),d(n,null,{default:i(()=>[d(y,{modelValue:l(f).productId,"onUpdate:modelValue":a[3]||(a[3]=t=>l(f).productId=t),placeholder:"\u4EA7\u54C1\u540D\u79F0"},{default:i(()=>[(c(!0),b(F,null,w(l(S),t=>(c(),D(m,{label:t.productName,value:t.productId,key:t.productId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})],64)),d(n,null,{default:i(()=>[d(y,{modelValue:l(f).departmentId,"onUpdate:modelValue":a[4]||(a[4]=t=>l(f).departmentId=t),placeholder:"\u9009\u62E9\u90E8\u95E8",onChange:U},{default:i(()=>[(c(!0),b(F,null,w(l(V),t=>(c(),D(m,{label:t.label,value:t.value,key:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),d(n,null,{default:i(()=>[d(y,{modelValue:l(f).userId,"onUpdate:modelValue":a[5]||(a[5]=t=>l(f).userId=t),placeholder:"\u9009\u62E9\u4EBA\u5458"},{default:i(()=>[(c(!0),b(F,null,w(l(E),t=>(c(),D(m,{label:t.userName,value:t.userId,key:t.userId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),d(n,null,{default:i(()=>[d(k,{type:"primary",onClick:Z},{default:i(()=>[ge]),_:1}),d(k,{type:"",onClick:X},{default:i(()=>[xe]),_:1})]),_:1})]),_:1},8,["model"])]),I("div",Ie,[d(ve,{width:"100%",height:"280px",data:l(p)},null,8,["data"])]),I("div",Ee,[I("div",Ae,[I("span",null,"\u9500\u552E\u6570\u91CF\uFF1A\xA5 "+j(l(B).salesVolume),1),I("span",null,"\u9500\u552E\u91D1\u989D\uFF1A\xA5 "+j(l(B).salesAmount),1)]),I("div",null,[ye((c(),D(k,{type:"primary",onClick:l(W)},{default:i(()=>[Fe]),_:1},8,["onClick"])),[[ee,"crm:client:report:export"]])])]),d(v,{comheight:590,style:{width:"100%"},isBorder:!0,isSelection:!1,isIndex:!1,isPagination:!1,isShowCustomBtn:!1,loading:!1,isHandle:!1,isShowPageBtn:!1,tableData:l(_),tableCols:l(A),tableHandles:l(C),onRefresh:H},null,8,["tableData","tableCols","tableHandles"])])}}});var Be=he(Ve,[["__scopeId","data-v-90d6266c"]]);const Ne={class:"main"},Le=P({__name:"index",setup(o){const u=q({activeName:"",list:[{label:"\u6309\u4EA7\u54C1\u6C47\u603B",value:"1"},{label:"\u6309\u5206\u7C7B\u6C47\u603B",value:"2"},{label:"\u6309\u65F6\u95F4\u6C47\u603B",value:"3"}]}),{activeName:e,list:f}=G(u),V=(E,C)=>{u.activeName=E.props.name};return K(()=>{u.activeName="1"}),(E,C)=>{const A=h("el-tab-pane"),_=h("el-tabs");return c(),b("div",Ne,[d(_,{modelValue:l(e),"onUpdate:modelValue":C[0]||(C[0]=p=>Q(e)?e.value=p:null),onTabClick:V,type:"border-card"},{default:i(()=>[(c(!0),b(F,null,w(l(f),(p,B)=>(c(),D(A,{label:p.label,key:B,name:p.value},{default:i(()=>[p.value==l(e)?(c(),D(Be,{key:0,activeName:l(e)},null,8,["activeName"])):De("",!0)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])])}}});export{Le as default};
