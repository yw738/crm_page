var X=Object.defineProperty,Y=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var q=(o,n,l)=>n in o?X(o,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):o[n]=l,L=(o,n)=>{for(var l in n||(n={}))ee.call(n,l)&&q(o,l,n[l]);if(O)for(var l of O(n))te.call(n,l)&&q(o,l,n[l]);return o},z=(o,n)=>Y(o,Z(n));import"./dict.c33b8edc.js";import{_ as M,d as j,q as G,r as P,V as le,L as H,M as J,a as c,b as i,f as F,h as g,c as x,e as r,m as a,x as m,F as R,g as K,G as S,t as w,U as oe,y as E,$ as ae,E as ne,a0 as se,o as ie,C as ue,aI as ce,p as re,l as de}from"./index.052afee0.js";import{F as pe,f as b}from"./FollowTask.dc6c96ed.js";const fe={key:1},_e={class:"dialog-footer",style:{"text-align":"left"}},ge=S("\u7F16\u8F91\u8DDF\u8FDB"),me=S("\u5220\u9664\u8DDF\u8FDB"),he=j({__name:"detail",emits:["success"],setup(o,{expose:n,emit:l}){G(),P(le);const u=H({visible:!1,formData:{},dataCal:[{label:"\u8DDF\u8FDB\u7C7B\u578B",value:"followInfoTypeName"},{label:"\u8DDF\u8FDB\u65B9\u5F0F",value:"followTypeName"},{label:"\u8DDF\u8FDB\u65F6\u95F4",value:"followTime"},{label:"\u8DDF\u8FDB\u63CF\u8FF0",value:"followContent"},{label:"\u5BA2\u6237\u540D\u79F0",value:"clientName",handClick:()=>{}},{label:"\u5BA2\u6237\u72B6\u6001",value:"clientState"},{label:"\u8054\u7CFB\u4EBA",value:"contactName"},{label:"\u76F8\u5173\u9644\u4EF6",value:"a",handClick:()=>{}},{label:"\u8DDF\u8FDB\u4EBA\u5458",value:"nextFollowUserName"},{label:"\u63D0\u9192\u8C01\u770B",value:"remindPeopleName"},{label:"\u521B\u5EFA\u65F6\u95F4",value:"followTime"}],remindPeople:[]}),C=P(null),{visible:B,dataCal:U,formData:T}=J(u);let N=async(e={})=>{var D,k;u.visible=!0;let t=null;await ae.queryEmployee().then(s=>{var f;u.remindPeople=(f=s.data)==null?void 0:f.map(y=>({label:y.name,value:y.id}))});let d="",v="",p="";try{e.followInfoType=="CLIENT"?(p="\u5BA2\u6237\u8DDF\u8FDB",t=await b.getDetail1(e.followId)):e.followInfoType=="CLUE"?(p="\u7EBF\u7D22\u8DDF\u8FDB",t=await b.getDetail2(e.followId)):e.followInfoType=="BUSINESS"?(p="\u5546\u673A\u8DDF\u8FDB",t=await b.getDetail3(e.followId)):e.followInfoType=="ORDER"&&(p="\u8BA2\u5355\u8DDF\u8FDB",t=await b.getDetail4(e.followId));let s=(D=t.data.remindPeople)==null?void 0:D.split(",");if(t.data.nextFollowUserId&&(d=(k=u.remindPeople.filter(f=>f.value==t.data.nextFollowUserId)[0])==null?void 0:k.label),s!=null&&s.length){let f="";u.remindPeople.forEach(y=>{s.includes(y.value.toString())&&(f?f=","+y.label:f=y.label)}),v=f}Object.assign(u.formData,z(L(z(L({},e),{followInfoTypeName:p,nextFollowUserName:d,remindPeopleName:v}),t.data),{followTypeName:e.followType}))}catch{}},h=()=>{var d;let e=u.formData,t="";e.followInfoType=="CLIENT"?t="customer":e.followInfoType=="CLUE"?t="clue":e.followInfoType=="BUSINESS"?t="business":e.followInfoType=="ORDER"&&(t="order"),(d=C==null?void 0:C.value)==null||d.init(t,z(L({},e),{isEdit:!0}))},I=async()=>{let e=u.formData;ne.confirm("\u8BE5\u6570\u636E\u5C06\u6C38\u4E45\u88AB\u5220\u9664\uFF0C\u5E76\u4E14\u65E0\u6CD5\u6062\u590D\u3002","\u786E\u5B9A\u5220\u9664\u8BE5\u6570\u636E\u5417\uFF1F").then(async()=>{var t,d,v,p;try{e.followInfoType=="CLIENT"?await((t=b)==null?void 0:t.delClientFollow(e.clientFollowId)):e.followInfoType=="CLUE"?await((d=b)==null?void 0:d.delClueFollow(e.clientFollowId)):e.followInfoType=="BUSINESS"?await((v=b)==null?void 0:v.delBusinessFollow(e.businessFollowId)):e.followInfoType=="ORDER"&&await((p=b)==null?void 0:p.delOrderFollow(e.orderFollowId)),se.success("\u5220\u9664\u6210\u529F"),l("success"),A()}catch{}}).catch(()=>{})};function A(){u.visible=!1,u.formData={}}return n({init:N}),(e,t)=>{const d=c("el-link"),v=c("el-descriptions-item"),p=c("el-descriptions"),D=c("el-button"),k=c("el-dialog");return i(),F(R,null,[g(B)?(i(),x(k,{key:0,title:"\u8DDF\u8FDB\u8BE6\u60C5",modelValue:g(B),"onUpdate:modelValue":t[0]||(t[0]=s=>oe(B)?B.value=s:null),width:"500px",onClose:A,"close-on-click-modal":!1,"append-to-body":""},{footer:r(()=>[a("div",_e,[m(D,{type:"primary",onClick:g(h)},{default:r(()=>[ge]),_:1},8,["onClick"]),m(D,{type:"danger",onClick:g(I)},{default:r(()=>[me]),_:1},8,["onClick"])])]),default:r(()=>[m(p,{column:1,border:""},{default:r(()=>[(i(!0),F(R,null,K(g(U),(s,f)=>(i(),x(v,{label:s.label+"\uFF1A","label-align":"right",align:"center","label-class-name":"my-label","class-name":"my-content",width:"100px"},{default:r(()=>[s.handClick?(i(),x(d,{key:0,onClick:s.handClick,underline:!1,type:"primary"},{default:r(()=>[S(w(g(T)[s.value]||"-"),1)]),_:2},1032,["onClick"])):(i(),F("span",fe,w(g(T)[s.value]||"-"),1))]),_:2},1032,["label"]))),256))]),_:1})]),_:1},8,["modelValue"])):E("",!0),m(pe,{ref_key:"followTaskRef",ref:C,onSuccess:g(N)},null,8,["onSuccess"])],64)}}});var ve=M(he,[["__scopeId","data-v-31704ef6"]]);const $=o=>(re("data-v-a4928f6c"),o=o(),de(),o),ye={style:{height:"100%"}},we={class:"flexBetween",style:{"margin-bottom":"20px"}},Fe={class:"titleClass el-descriptions__title"},De={class:"flexStart"},be={style:{overflow:"auto",height:"calc(100% - 52px - 60px)"}},xe={key:0,class:"biaoqian flexStart"},Ce=$(()=>a("div",null,null,-1)),Be={class:"flexBetween top"},ke={class:"flexStart"},Ee={style:{margin:"0 10px"}},Ie={class:"flexStart"},Se={style:{"margin-right":"5px"}},Te={style:{"margin-bottom":"3px"}},Ne={class:"content"},Ae={key:0,class:"flexBetween bottom"},Le=$(()=>a("span",{style:{color:"#666"}},"\u6765\u81EA\u5BA2\u6237\uFF1A",-1)),ze={key:0},Ue=S("\u8BE6\u60C5"),Pe={key:0,class:"ces-pagination"},Re=$(()=>a("span",null,null,-1)),$e=j({__name:"index",props:{tableData:{type:Array,default:()=>[]},pagination:{type:Object,default:()=>({pageSize:10,pageIndex:1,total:0})},fileDownType:{type:String,default:""},searchData:{type:Object,default:()=>({})},title:{type:String,default:"\u8DDF\u8FDB\u8BB0\u5F55"},isShowBtn:{type:Boolean,default:!0},isShowPagination:{type:Boolean,default:!0}},emits:["getList","success"],setup(o,{emit:n}){const l=o;G();const u=P(null),C=H({});J(C),ie(()=>{});let B=h=>{l.pagination.pageIndex=h,n("getList")},U=h=>{l.pagination.pageSize=h,n("getList")};const T=()=>{n("success")};let N=h=>{var I;(I=u==null?void 0:u.value)==null||I.init(h)};return(h,I)=>{var y,V;const A=c("el-avatar"),e=c("Stopwatch"),t=c("el-icon"),d=c("el-link"),v=c("el-button"),p=c("el-card"),D=c("el-timeline-item"),k=c("el-timeline"),s=c("el-result"),f=c("el-pagination");return i(),F("div",ye,[a("div",we,[a("div",Fe,w(o.title),1),a("div",De,[ue(h.$slots,"default",{},void 0,!0)])]),a("div",be,[(y=l.tableData)!=null&&y.length?(i(),x(k,{key:0},{default:r(()=>[(i(!0),F(R,null,K(l.tableData,(_,Q)=>(i(),x(D,{key:Q,type:"primary",center:_.hollow,hollow:!_.hollow,placement:"top"},{default:r(()=>[_.hollow?(i(),F("div",xe,[Ce,a("div",null,w(_.time||""),1)])):(i(),x(p,{key:1},{default:r(()=>[a("div",Be,[a("div",ke,[a("div",null,[m(A,{icon:"UserFilled"})]),a("div",Ee,w(_.creatorName||""),1),a("div",null,w(_.followType||""),1)]),a("div",Ie,[a("div",Se,[m(t,null,{default:r(()=>[m(e)]),_:1})]),a("div",Te,w(_.createTime),1)])]),a("div",Ne,w(_.followContent||""),1),_.clientName?(i(),F("div",Ae,[a("div",null,[Le,m(d,{underline:!1,onClick:W=>g(ce)(_)},{default:r(()=>[S(w(_.clientName||""),1)]),_:2},1032,["onClick"])]),o.isShowBtn?(i(),F("div",ze,[m(v,{icon:"More",onClick:W=>g(N)(_)},{default:r(()=>[Ue]),_:2},1032,["onClick"])])):E("",!0)])):E("",!0)]),_:2},1024))]),_:2},1032,["center","hollow"]))),128))]),_:1})):E("",!0),(V=l.tableData)!=null&&V.length?E("",!0):(i(),x(s,{key:1,icon:"info","sub-title":"\u6682\u65E0\u6570\u636E",title:""}))]),o.isShowPagination?(i(),F("div",Pe,[Re,m(f,{class:"el_pagination",onCurrentChange:g(B),onSizeChange:g(U),background:"","page-sizes":[10,20,30,40,50,100],layout:"sizes ,prev, pager, next","page-size":l.pagination.pageSize,"current-page":l.pagination.pageIndex,total:l.pagination.total},null,8,["onCurrentChange","onSizeChange","page-size","current-page","total"])])):E("",!0),m(ve,{ref_key:"detailRef",ref:u,onSuccess:T},null,512)])}}});var je=M($e,[["__scopeId","data-v-a4928f6c"]]);export{je as F};
